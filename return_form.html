<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å”®å¾Œæœå‹™ä¸­å¿ƒ | æ‚¨çš„å€‹äººå“ç‰Œ</title>
    <style>
        /* CSS æ¨£å¼å€ */
        body {
            font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #333;
        }

        .container {
            background: white;
            width: 100%;
            max-width: 600px; /* ç¨å¾®åŠ å¯¬ä»¥å®¹ç´ç”¢å“åˆ—è¡¨ */
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        h2 {
            text-align: center;
            color: #1a1a1a;
            margin-bottom: 10px;
            font-size: 24px;
        }

        .sub-title {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
            font-size: 15px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 15px;
            transition: border-color 0.3s;
            background-color: #fff;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #007bff;
            outline: none;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }

        /* ç”¢å“åˆ—è¡¨æ¨£å¼ */
        .product-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        
        .product-name-input {
            flex: 3; /* ç”¢å“åç¨±ä½”å¯¬ä¸€é» */
        }
        
        .product-qty-input {
            flex: 1; /* æ•¸é‡æ¬„ä½çª„ä¸€é» */
            text-align: center;
        }

        .add-row-btn {
            background-color: #f8f9fa;
            border: 1px dashed #ccc;
            color: #555;
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .add-row-btn:hover {
            background-color: #e9ecef;
            border-color: #adb5bd;
            color: #333;
        }

        /* å‹•æ…‹å€å¡Š */
        .dynamic-section {
            display: none;
            background-color: #f8f9fa;
            padding: 20px;
            border-left: 4px solid #007bff;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        /* æäº¤æŒ‰éˆ• */
        .submit-btn {
            width: 100%;
            padding: 14px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s, transform 0.1s;
        }

        .submit-btn:hover {
            background-color: #0056b3;
        }

        .submit-btn:active {
            transform: scale(0.98);
        }

        /* æˆåŠŸè¨Šæ¯é®ç½© */
        #successModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }
        .check-icon {
            color: #28a745;
            font-size: 50px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>å”®å¾Œæœå‹™ç”³è«‹</h2>
    <p class="sub-title">è«‹å¡«å¯«è©³ç´°è³‡è¨Šï¼Œæˆ‘å€‘å°‡åœ¨æ”¶åˆ°å¾Œå„˜é€Ÿç‚ºæ‚¨è™•ç†ã€‚</p>
    
    <form id="returnForm">
        
        <!-- åŸºæœ¬è³‡æ–™ -->
        <div class="form-group">
            <label for="orderId">è¨‚å–®ç·¨è™Ÿ / å®¢æˆ¶åç¨±</label>
            <input type="text" id="orderId" placeholder="ä¾‹å¦‚ï¼š20241215-01 æˆ– ç‹å°æ˜" required>
        </div>

        <!-- æœå‹™é¡åˆ¥ (åˆ‡æ›é–‹é—œ) -->
        <div class="form-group">
            <label for="serviceType">æœå‹™é¡åˆ¥</label>
            <select id="serviceType" onchange="toggleFields()" required>
                <option value="" disabled selected>-- è«‹é¸æ“‡æœå‹™é …ç›® --</option>
                <option value="return">1. éŠ·è²¨é€€è²¨ (è²·éŒ¯/ä¸é©ç”¨)</option>
                <option value="sample">2. æ¨£å“æ­¸é‚„ (è©¦ç”¨å®Œç•¢)</option>
                <option value="exchange">3. æ–°å“ä¸è‰¯ (æ›è²¨/ç¶­ä¿®)</option>
            </select>
        </div>

        <!-- ç”¢å“æ¸…å–®å€å¡Š (å‹•æ…‹å¢åŠ ) -->
        <div class="form-group">
            <label>ç”¢å“æ˜ç´° (åç¨±/å‹è™Ÿ èˆ‡ æ•¸é‡)</label>
            <div id="productListContainer">
                <!-- JavaScript æœƒåœ¨é€™è£¡è‡ªå‹•ç”Ÿæˆ 7 è¡Œ -->
            </div>
            <button type="button" class="add-row-btn" onclick="addNewRow()">+ å¢åŠ ä¸€é …ç”¢å“</button>
        </div>

        <!-- å‹•æ…‹å€å¡Š Aï¼šéŠ·è²¨é€€è²¨ -->
        <div id="section-return" class="dynamic-section">
            <label>é€€æ¬¾å¸³æˆ¶è³‡è¨Š</label>
            <div style="display:flex; gap:10px;">
                <input type="text" id="bankCode" placeholder="éŠ€è¡Œä»£ç¢¼ (å¦‚: 822)" style="flex:1;">
                <input type="text" id="bankAccount" placeholder="éŠ€è¡Œå¸³è™Ÿ" style="flex:3;">
            </div>
            <small style="color:#666; display:block; margin-top:5px;">* æ ¸å¯¦å•†å“ç„¡èª¤å¾Œï¼Œæ¬¾é …å°‡é€€è‡³æ­¤å¸³æˆ¶ã€‚</small>
        </div>

        <!-- å‹•æ…‹å€å¡Š Bï¼šæ¨£å“æ­¸é‚„ -->
        <div id="section-sample" class="dynamic-section">
            <label>é è¨ˆæ­¸é‚„æ—¥æœŸ</label>
            <input type="date" id="returnDate">
        </div>

        <!-- å‹•æ…‹å€å¡Š Cï¼šæ–°å“ä¸è‰¯ -->
        <div id="section-exchange" class="dynamic-section">
            <label>æ–¹ä¾¿å¸æ©Ÿäº¤æ›ä»¶æ™‚æ®µ</label>
            <select id="pickupTime">
                <option value="any">ä¸é™çš†å¯</option>
                <option value="morning">ä¸Šåˆ (09:00 - 12:00)</option>
                <option value="afternoon">ä¸‹åˆ (13:00 - 18:00)</option>
            </select>
            <div style="margin-top:15px; background:#fff8d6; padding:12px; border-radius:6px; font-size:14px; color:#856404;">
                <strong>ğŸ’¡ æ•…éšœæ’é™¤å°æ’‡æ­¥ï¼š</strong><br>
                å¯„å‡ºå‰ï¼Œå»ºè­°æ‚¨å…ˆå˜—è©¦é‡ç½®è¨­å‚™ï¼Œé€™èƒ½è§£æ±º 80% çš„é€£ç·šå•é¡Œå–”ï¼
            </div>
        </div>

        <!-- è¯çµ¡è³‡è¨Š -->
        <div class="form-group">
            <label for="contactPhone">è¯çµ¡é›»è©±</label>
            <input type="tel" id="contactPhone" required>
        </div>

        <div class="form-group">
            <label for="note">å‚™è¨» (é¸å¡«)</label>
            <textarea id="note" rows="3" placeholder="ä¾‹å¦‚ï¼šé…ä»¶ç¼ºæ¼ã€å¤–ç®±å—æ..."></textarea>
        </div>

        <button type="submit" class="submit-btn">é€å‡ºç”³è«‹å–®</button>
    </form>
</div>

<!-- æˆåŠŸæç¤ºè¦–çª— -->
<div id="successModal">
    <div class="modal-content">
        <div class="check-icon">âœ“</div>
        <h3>ç”³è«‹å·²é€å‡º</h3>
        <p>æˆ‘å€‘æœƒç›¡å¿«å¯©æ ¸ï¼Œä¸¦é€é Email é€šçŸ¥æ‚¨é€²åº¦ã€‚</p>
        <button class="submit-btn" style="margin-top:15px;" onclick="closeModal()">å¥½çš„ï¼Œæˆ‘çŸ¥é“äº†</button>
    </div>
</div>

<script>
    // é é¢è¼‰å…¥æ™‚ï¼Œè‡ªå‹•ç”¢ç”Ÿ 7 åˆ—ç”¢å“è¼¸å…¥æ ¼
    window.onload = function() {
        for(let i=0; i<7; i++) {
            addNewRow();
        }
    }

    // æ–°å¢ä¸€åˆ—ç”¢å“è¼¸å…¥æ ¼çš„åŠŸèƒ½
    function addNewRow() {
        const container = document.getElementById('productListContainer');
        const index = container.children.length + 1; // å–å¾—ç›®å‰æ˜¯ç¬¬å¹¾é …
        
        const row = document.createElement('div');
        row.className = 'product-row';
        row.innerHTML = `
            <input type="text" class="product-name-input" name="productName[]" placeholder="é …ç›® ${index}ï¼šç”¢å“åç¨± / å‹è™Ÿ">
            <input type="number" class="product-qty-input" name="productQty[]" placeholder="æ•¸é‡" min="1" value="1">
        `;
        container.appendChild(row);
    }

    // åˆ‡æ›æœå‹™é¡åˆ¥é¡¯ç¤º
    function toggleFields() {
        var type = document.getElementById("serviceType").value;
        
        // éš±è—æ‰€æœ‰å€å¡Š
        document.getElementById("section-return").style.display = "none";
        document.getElementById("section-sample").style.display = "none";
        document.getElementById("section-exchange").style.display = "none";

        // é¡¯ç¤ºå°æ‡‰å€å¡Š
        if (type) {
            document.getElementById("section-" + type).style.display = "block";
        }
    }

    // è™•ç†è¡¨å–®é€å‡º
    document.getElementById("returnForm").addEventListener("submit", function(e){
        e.preventDefault();
        
        // è’é›†ç”¢å“è³‡æ–™çš„é‚è¼¯ç¤ºç¯„ (æœªä¾†å‚³é€çµ¦ Firebase ç”¨)
        const productNames = document.getElementsByName('productName[]');
        const productQtys = document.getElementsByName('productQty[]');
        let products = [];
        
        for(let i=0; i<productNames.length; i++) {
            if(productNames[i].value.trim() !== "") {
                products.push({
                    name: productNames[i].value,
                    qty: productQtys[i].value
                });
            }
        }

        // å¦‚æœé€£ä¸€å€‹ç”¢å“éƒ½æ²’å¡«
        if(products.length === 0) {
            alert("è«‹è‡³å°‘å¡«å¯«ä¸€é …ç”¢å“è³‡è¨Š");
            return;
        }

        console.log("æº–å‚™é€å‡ºçš„è³‡æ–™:", products);
        
        // é¡¯ç¤ºæˆåŠŸè¦–çª—
        document.getElementById("successModal").style.display = "flex";
    });

    // é—œé–‰æˆåŠŸè¦–çª—
    function closeModal() {
        document.getElementById("successModal").style.display = "none";
        document.getElementById("returnForm").reset(); // æ¸…ç©ºè¡¨å–®
        
        // é‡ç½®ç‚º 7 è¡Œç©ºè¡¨æ ¼
        document.getElementById('productListContainer').innerHTML = '';
        for(let i=0; i<7; i++) { addNewRow(); }
        
        // é‡ç½®å‹•æ…‹å€å¡Šéš±è—
        toggleFields();
    }
</script>

</body>
</html>
